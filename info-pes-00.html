<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>PiZero-WU - Info</title>

  <!-- Wiki CSS styles for content in scrollable div -->
  <link href="info-css.css" rel="stylesheet">

  <!-- Custom fonts for this template-->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">

  <!-- Page level plugin CSS-->
  <link href="vendor/datatables/dataTables.bootstrap4.css" rel="stylesheet">

  <!-- Custom styles for this template-->
  <link href="css/sb-admin.css" rel="stylesheet">


</head>

<body id="page-top">

  <nav class="navbar navbar-expand navbar-dark bg-dark static-top">

    <a class="navbar-brand mr-1" href="/nwadmin">PiZero-WU</a>

    <button class="btn btn-link btn-sm text-white order-1 order-sm-0" id="sidebarToggle" href="#">
      <i class="fas fa-bars"></i>
    </button>

    <!-- Navbar Search -->
    <!--
    <form class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Search for..." aria-label="Search" aria-describedby="basic-addon2">
        <div class="input-group-append">
          <button class="btn btn-primary" type="button">
            <i class="fas fa-search"></i>
          </button>
        </div>
      </div>
    </form>
    -->

    <!-- Navbar -->
    <ul class="navbar-nav ml-auto ml-md-0">

      <!-- No Navbar items
      <li class="nav-item dropdown no-arrow mx-1">
        <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-bell fa-fw"></i>
          <span class="badge badge-danger">9+</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="alertsDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>
      <li class="nav-item dropdown no-arrow mx-1">
        <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-envelope fa-fw"></i>
          <span class="badge badge-danger">7</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="messagesDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>
      <li class="nav-item dropdown no-arrow">
        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-user-circle fa-fw"></i>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
          <a class="dropdown-item" href="#">Settings</a>
          <a class="dropdown-item" href="#">Activity Log</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">Logout</a>
        </div>
      </li>
      -->
    </ul>

  </nav>

  <div id="wrapper">

    <!-- Sidebar -->
    <ul class="sidebar navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/nwadmin">
          <i class="fas fa-fw fa-tachometer-alt"></i>
          <span>Dashboard</span>
        </a>
      </li>

      <!-- Not these Sidebar items
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="pagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-fw fa-folder"></i>
          <span>Pages</span>
        </a>
        <div class="dropdown-menu" aria-labelledby="pagesDropdown">
          <h6 class="dropdown-header">Login Screens:</h6>
          <a class="dropdown-item" href="login.html">Login</a>
          <a class="dropdown-item" href="register.html">Register</a>
          <a class="dropdown-item" href="forgot-password.html">Forgot Password</a>
          <div class="dropdown-divider"></div>
          <h6 class="dropdown-header">Other Pages:</h6>
          <a class="dropdown-item" href="404.html">404 Page</a>
          <a class="dropdown-item active" href="blank.html">Blank Page</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="charts.html">
          <i class="fas fa-fw fa-chart-area"></i>
          <span>Charts</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="tables.html">
          <i class="fas fa-fw fa-table"></i>
          <span>Tables</span></a>
      </li>
      --> 
    </ul>

    <div id="content-wrapper">

      <div class="container-fluid">

        <!-- Breadcrumbs-->
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="/nwadmin">Dashboard</a>
          </li>
          <li class="breadcrumb-item active">Info</li>
        </ol>

        <!-- Page Content -->

        <div style="height:700px;width:100%;border:solid 2px gray;overflow:scroll;overflow-x:hidden;overflow-y:scroll;padding-top: 10px;  padding-right: 10px; padding-bottom: 10px; padding-left: 10px;">
          
        <h1 id="firstHeading" class="firstHeading" lang="en"></h1>
        <h1><i class="fas fa-fw fa-info"></i> Info - Embroidery format PES</h1>
        <hr>


  <div id="mw-page-base" class="noprint"></div>
  <div id="mw-head-base" class="noprint"></div>
  <div id="content" class="mw-body" role="main">
  <a id="top"></a>
  <div class="mw-indicators mw-body-content"></div>

  
  <div id="bodyContent" class="mw-body-content">
  <div id="contentSub"></div>

<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
  <li class="toclevel-1 tocsection-1"><a href="#PES_overview"><span class="tocnumber">1</span> <span class="toctext">PES overview</span></a>
    <ul>
      <li class="toclevel-2 tocsection-2"><a href="#File_Format"><span class="tocnumber">1.1</span> <span class="toctext">File Format</span></a>
        <ul>
          <li class="toclevel-3 tocsection-3"><a href="#Sections"><span class="tocnumber">1.1.1</span> <span class="toctext">Sections</span></a></li>
          <li class="toclevel-3 tocsection-4"><a href="#Basic_types"><span class="tocnumber">1.1.2</span> <span class="toctext">Basic types</span></a></li>
        </ul>
      </li>
      <li class="toclevel-2 tocsection-5"><a href="#PES_Objects"><span class="tocnumber">1.2</span> <span class="toctext">PES Objects</span></a>
        <ul>
          <li class="toclevel-3 tocsection-6"><a href="#Geometry"><span class="tocnumber">1.2.1</span> <span class="toctext">Geometry</span></a></li>
          <li class="toclevel-3 tocsection-7"><a href="#Extents"><span class="tocnumber">1.2.2</span> <span class="toctext">Extents</span></a></li>
          <li class="toclevel-3 tocsection-8"><a href="#Affine_transform"><span class="tocnumber">1.2.3</span> <span class="toctext">Affine transform</span></a></li>
          <li class="toclevel-3 tocsection-9"><a href="#Block_Description"><span class="tocnumber">1.2.4</span> <span class="toctext">Block Description</span></a></li>
          <li class="toclevel-3 tocsection-10"><a href="#Motif"><span class="tocnumber">1.2.5</span> <span class="toctext">Motif</span></a></li>
          <li class="toclevel-3 tocsection-11"><a href="#Tile_line"><span class="tocnumber">1.2.6</span> <span class="toctext">Tile line</span></a></li>
        </ul>
     </li>
     <li class="toclevel-2 tocsection-12"><a href="#Header"><span class="tocnumber">1.3</span> <span class="toctext">Header</span></a>
     <ul>
       <li class="toclevel-3 tocsection-13"><a href="#Version_1_header_section"><span class="tocnumber">1.3.1</span> <span class="toctext">Version 1 header section</span></a></li>
       <li class="toclevel-3 tocsection-14"><a href="#Version_2_header_section"><span class="tocnumber">1.3.2</span> <span class="toctext">Version 2 header section</span></a></li>
       <li class="toclevel-3 tocsection-15"><a href="#Version_2.5_header_section"><span class="tocnumber">1.3.3</span> <span class="toctext">Version 2.5 header section</span></a></li>
       <li class="toclevel-3 tocsection-16"><a href="#Version_3_header_section"><span class="tocnumber">1.3.4</span> <span class="toctext">Version 3 header section</span></a></li>
       <li class="toclevel-3 tocsection-17"><a href="#Version_4_header_section"><span class="tocnumber">1.3.5</span> <span class="toctext">Version 4 header section</span></a></li>
       <li class="toclevel-3 tocsection-18"><a href="#Version_5_header_section"><span class="tocnumber">1.3.6</span> <span class="toctext">Version 5 header section</span></a></li>
       <li class="toclevel-3 tocsection-19"><a href="#Version_6_header_section"><span class="tocnumber">1.3.7</span> <span class="toctext">Version 6 header section</span></a></li>
       <li class="toclevel-3 tocsection-20"><a href="#Programmable_fill_subsection"><span class="tocnumber">1.3.8</span> <span class="toctext">Programmable fill subsection</span></a></li>
       <li class="toclevel-3 tocsection-21"><a href="#Motif_subsection"><span class="tocnumber">1.3.9</span> <span class="toctext">Motif subsection</span></a></li>
       <li class="toclevel-3 tocsection-22"><a href="#Feather_Pattern_Subsection"><span class="tocnumber">1.3.10</span> <span class="toctext">Feather Pattern Subsection</span></a></li>
       <li class="toclevel-3 tocsection-23"><a href="#Hoop_size_subsection"><span class="tocnumber">1.3.11</span> <span class="toctext">Hoop size subsection</span></a></li>
       <li class="toclevel-3 tocsection-24"><a href="#Description_strings_subsection"><span class="tocnumber">1.3.12</span> <span class="toctext">Description strings subsection</span></a></li>
       <li class="toclevel-3 tocsection-25"><a href="#Color_list_subsection"><span class="tocnumber">1.3.13</span> <span class="toctext">Color list subsection</span></a></li>
       <li class="toclevel-3 tocsection-26"><a href="#Color_subsection"><span class="tocnumber">1.3.14</span> <span class="toctext">Color subsection</span></a></li>
     </ul>
  </li>
  <li class="toclevel-2 tocsection-27"><a href="#CEmbOne"><span class="tocnumber">1.4</span> <span class="toctext">CEmbOne</span></a></li>
  <li class="toclevel-2 tocsection-28"><a href="#CSewSeg"><span class="tocnumber">1.5</span> <span class="toctext">CSewSeg</span></a>
    <ul>
      <li class="toclevel-3 tocsection-29"><a href="#CSewSeg_segment_block"><span class="tocnumber">1.5.1</span> <span class="toctext">CSewSeg segment block</span></a>
        <ul>
          <li class="toclevel-4 tocsection-30"><a href="#CSewSeg_stitch_list_subsection"><span class="tocnumber">1.5.1.1</span> <span class="toctext">CSewSeg stitch list subsection</span></a></li>
          <li class="toclevel-4 tocsection-31"><a href="#CSewSeg_coordinate_subsection"><span class="tocnumber">1.5.1.2</span> <span class="toctext">CSewSeg coordinate subsection</span></a></li>
          <li class="toclevel-4 tocsection-32"><a href="#CSewSeg_color_list_subsection"><span class="tocnumber">1.5.1.3</span> <span class="toctext">CSewSeg color list subsection</span></a></li>
          <li class="toclevel-4 tocsection-33"><a href="#CSewSeg_color_subsection"><span class="tocnumber">1.5.1.4</span> <span class="toctext">CSewSeg color subsection</span></a></li>
        </ul>
      </li>
      <li class="toclevel-3 tocsection-34"><a href="#CEmbOne_Header"><span class="tocnumber">1.5.2</span> <span class="toctext">CEmbOne Header</span></a></li>
    </ul>
  </li>
  <li class="toclevel-2 tocsection-35"><a href="#CEmbCirc"><span class="tocnumber">1.6</span> <span class="toctext">CEmbCirc</span></a></li>
  <li class="toclevel-2 tocsection-36"><a href="#CEmbRect"><span class="tocnumber">1.7</span> <span class="toctext">CEmbRect</span></a></li>
  <li class="toclevel-2 tocsection-37"><a href="#CEmbLine"><span class="tocnumber">1.8</span> <span class="toctext">CEmbLine</span></a>
    <ul>
      <li class="toclevel-3 tocsection-38"><a href="#Point_List"><span class="tocnumber">1.8.1</span> <span class="toctext">Point List</span></a></li>
    </ul>
  </li>
  <li class="toclevel-2 tocsection-39"><a href="#CEmbPunch"><span class="tocnumber">1.9</span> <span class="toctext">CEmbPunch</span></a></li>
  <li class="toclevel-2 tocsection-40"><a href="#CSewFigSeg"><span class="tocnumber">1.10</span> <span class="toctext">CSewFigSeg</span></a></li>
  <li class="toclevel-2 tocsection-41"><a href="#CLetter"><span class="tocnumber">1.11</span> <span class="toctext">CLetter</span></a></li>
  <li class="toclevel-2 tocsection-42"><a href="#CEmbNText"><span class="tocnumber">1.12</span> <span class="toctext">CEmbNText</span></a></li>
  <li class="toclevel-2 tocsection-43"><a href="#PEC_Addendum"><span class="tocnumber">1.13</span> <span class="toctext">PEC Addendum</span></a>
    <ul>
      <li class="toclevel-3 tocsection-44"><a href="#PEC_Addendum_header"><span class="tocnumber">1.13.1</span> <span class="toctext">PEC Addendum header</span></a></li>
      <li class="toclevel-3 tocsection-45"><a href="#PEC_Addendum_color_info"><span class="tocnumber">1.13.2</span> <span class="toctext">PEC Addendum color info</span></a></li>
      <li class="toclevel-3 tocsection-46"><a href="#PEC_Addendum_RGB_List"><span class="tocnumber">1.13.3</span> <span class="toctext">PEC Addendum RGB List</span></a></li>
    </ul>
  </li>
  <li class="toclevel-2 tocsection-47"><a href="#Write_PES_V.1"><span class="tocnumber">1.14</span> <span class="toctext">Write PES V.1</span></a>
    <ul>
      <li class="toclevel-3 tocsection-48"><a href="#Write_CEmbOne"><span class="tocnumber">1.14.1</span> <span class="toctext">Write CEmbOne</span></a></li>
      <li class="toclevel-3 tocsection-49"><a href="#Write_CSewSeg"><span class="tocnumber">1.14.2</span> <span class="toctext">Write CSewSeg</span></a></li>
      <li class="toclevel-3 tocsection-50"><a href="#Writing_Segment_Information"><span class="tocnumber">1.14.3</span> <span class="toctext">Writing Segment Information</span></a>
        <ul>
          <li class="toclevel-4 tocsection-51"><a href="#Color_Change.2C_Initialize"><span class="tocnumber">1.14.3.1</span> <span class="toctext">Color Change, Initialize</span></a></li>
          <li class="toclevel-4 tocsection-52"><a href="#Color_Change.2C_Middle"><span class="tocnumber">1.14.3.2</span> <span class="toctext">Color Change, Middle</span></a></li>
          <li class="toclevel-4 tocsection-53"><a href="#Jump"><span class="tocnumber">1.14.3.3</span> <span class="toctext">Jump</span></a></li>
          <li class="toclevel-4 tocsection-54"><a href="#Stitch"><span class="tocnumber">1.14.3.4</span> <span class="toctext">Stitch</span></a></li>
          <li class="toclevel-4 tocsection-55"><a href="#Color_change"><span class="tocnumber">1.14.3.5</span> <span class="toctext">Color change</span></a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li class="toclevel-2 tocsection-56"><a href="#Write_PES_v.6"><span class="tocnumber">1.15</span> <span class="toctext">Write PES v.6</span></a>
    <ul>
      <li class="toclevel-3 tocsection-57"><a href="#Write_Order_Data"><span class="tocnumber">1.15.1</span> <span class="toctext">Write Order Data</span></a></li>
      <li class="toclevel-3 tocsection-58"><a href="#Write_Addendum_block"><span class="tocnumber">1.15.2</span> <span class="toctext">Write Addendum block</span></a></li>
    </ul>
  </li>
  <li class="toclevel-2 tocsection-59"><a href="#Write_Truncated_v.6"><span class="tocnumber">1.16</span> <span class="toctext">Write Truncated v.6</span></a></li>
  <li class="toclevel-2 tocsection-60"><a href="#Write_PEC_v.1"><span class="tocnumber">1.17</span> <span class="toctext">Write PEC v.1</span></a></li>
  <li class="toclevel-2 tocsection-61"><a href="#Write_Truncated_PES_v.1"><span class="tocnumber">1.18</span> <span class="toctext">Write Truncated PES v.1</span></a>
    <ul>
      <li class="toclevel-3 tocsection-62"><a href="#Notes"><span class="tocnumber">1.18.1</span> <span class="toctext">Notes</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-63"><a href="#Writing_Ultra-Trucated_PES_v.1"><span class="tocnumber">1.19</span> <span class="toctext">Writing Ultra-Trucated PES v.1</span></a>
<ul>
<li class="toclevel-3 tocsection-64"><a href="#Notes_2"><span class="tocnumber">1.19.1</span> <span class="toctext">Notes</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-65"><a href="#PES_Block_Removing"><span class="tocnumber">1.20</span> <span class="toctext">PES Block Removing</span></a></li>
<li class="toclevel-2 tocsection-66"><a href="#PEC_Block_Removal"><span class="tocnumber">1.21</span> <span class="toctext">PEC Block Removal</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="PES_overview"><span class="mw-headline-number">1</span> PES overview</span></h1>
<p>The PES format is a hybrid embroidery design and embroidery command file format for Brother Industries and Bernina International series of embroidery machines, among others.
</p><p>PES files contain at their core two different parts for two completely different purposes. The PES part contains the design information for Brother PE-Design and perhaps similar applications. And the PEC part contain the design name, colors, embroidery machine commands, and graphics for the embroidery machine. Since the PEC block is the same in all versions so that it's always backwards compatible with the hardware of the Brother and Bernina embroidery machines, software made by others therefore tends to only read that data and turns those commands into line segments. However, later versions of PES version 4+ have addendum information about the PEC block that wouldn't interfere with the processing of the PEC block but contains information relevant to the embroidery machine.
</p><p>In PES version 1, the only blocks contained within the version 1 of the format were the CEmbOne and CSewSeg blocks. These blocks contain the affine transformation data for the position data, and the position data. These can be grouped in a few different ways but they only ever contain sewing segment information. So within PESv1 we end up with two copies of the same data in each of their respective blocks. The PES data has a copy of the segments and the PEC data has a copy of the segments.
</p><p>Later versions of PES have higher level objects which contain vector shapes and information about how these are filled when it renders. If a PES version 6 design, for example, contained a rectangle object. The PES block would have a <a href="#PES-CEmbRect-section">CEmbRect</a> object only. The PEC block would have all the commands for the machine to sew that according to the pathing chosen by the instance that saved the PES file. The reason for this is if Brother PE-Design loses the information it used to generate the PEC data namely that it was a rectangle at this specific location it becomes impossible to do operations like change the spacing between the scanlines within the rectangle, because after reloading the file all the program would have access to are the line segments; losing the shape makes rerendering that shape with a different fill density impossible.
</p><p>Fully grasping these elements of the format allow for creating interesting custom files or ways to modify them in logically consistent but weird methods.
</p><p>Some later PES versions also contain addendum PEC information. It occurs in ways that cannot interfere with reading a PEC block standardly but seems to provide additional expected information in PES version 4 and above, and is expected on later machines.
</p>
<h2><span class="mw-headline" id="File_Format"><span class="mw-headline-number">1.1</span> File Format</span></h2>
<p>The PES file consists of the version data `#PES0001`, `#PES0020`, `#PES0030`, `#PES0040`, `#PES0050`, `#PES0055`, `#PES0060`. This is followed by the PEC seek value, as a 4 byte little-endian integer. Then within the file the two main sections the <a href="#PES-section">PES</a> and the <a href="#PEC-section">PEC</a>. The PES section must immediately follow this and often the version and the PEC seek value are considered in the context of the header. The PEC section can occur anywhere. The seek value must point to it though. Outside directly manipulating the pointers, these occur immediately after each other with the seek value set to the appropriate location.
</p><p>The PES and PEC sections are distinct and disjoint and have their own conventions, purposes, formats, read values, etc. You will always find shorts in PEC block. It's all PEC writes. Whereas PES will in places read and write 4-byte integers and floating point numbers. The PEC section is a 16 bit format. PES section is a 32 bit format. PES is variable and valid things in one version are invalid in the next, and the header is different for each version. Whereas PEC needs to be consistent and remain backwards compatible so all future embroidery machines can read any PES files.
</p>
<h3><span class="mw-headline" id="Sections"><span class="mw-headline-number">1.1.1</span> Sections</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Section</th>
<th>Description
</th></tr>
<tr>
<td>PES Section</td>
<td>High-level embroidery design data, primarily for embroidery design applications
</td></tr>
<tr>
<td>PEC Section</td>
<td>Low-level embroidery machine data, primarily for embroidery hardware
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Basic_types"><span class="mw-headline-number">1.1.2</span> Basic types</span></h3>
<p>All integer and floating point numbers are stored in little-endian byte order unless otherwise noted.
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>1</td>
<td>ASCII text (not `NUL` terminated)
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>8 bit unsigned integer
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>16 bit unsigned integer
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>16 bit signed integer in stitch coordinate space where `1` represents 0.1 mm
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td>32 bit unsigned integer
</td></tr>
<tr>
<td>`f32`</td>
<td>4</td>
<td>32 bit [<a class="external text" href="https://en.wikipedia.org/wiki/Single-precision_floating-point_format%7C">floating point number</a>]
</td></tr></tbody></table>
<h2><span class="mw-headline" id="PES_Objects"><span class="mw-headline-number">1.2</span> PES Objects</span></h2>
<p>Some basic forms are found within many different PES sections.
</p>
<h3><span class="mw-headline" id="Geometry"><span class="mw-headline-number">1.2.1</span> Geometry</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td><a href="#extents">`extents`</a></td>
<td>16</td>
<td></td>
<td>Extents, the hitbox for the particular object
</td></tr>
<tr>
<td><a href="#affine-transform">`affine_transform`</a></td>
<td>24</td>
<td></td>
<td>Affine transform
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Extents"><span class="mw-headline-number">1.2.2</span> Extents</span></h3>
<p>The distinction between these two copies of the same data is currently unknown. However, modifying these cause the selection box within PE-Design to go a bit weird.
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Description
</th></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Left
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Top
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Right
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Bottom
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Left Position
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Top Position
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Right Position
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Bottom Position
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Affine_transform"><span class="mw-headline-number">1.2.3</span> Affine transform</span></h3>
<p>And [<a class="external text" href="https://en.wikipedia.org/wiki/Affine_transformation">affine transformation</a>] is 9 floating point values, usually stored as 6 (because the other three are always 0, 0, 1). It’s a matrix by which any series of affine [<a class="external text" href="https://www.youtube.com/watch?v=vQ60rFwh2ig">geometric operations</a>] namely scaling, skewing, and transforming can be performed in a single calculation for any number of points. We should usually just use the identity matrix here.
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`f32`</td>
<td>4</td>
<td>`1.0f` (identity)</td>
<td>Row 1 column 1, scale X
</td></tr>
<tr>
<td>`f32`</td>
<td>4</td>
<td>`0.0f` (identity)</td>
<td>Row 2 column 1, skew Y
</td></tr>
<tr>
<td>`f32`</td>
<td>4</td>
<td>`0.0f` (identity)</td>
<td>Row 1 column 2, skew X
</td></tr>
<tr>
<td>`f32`</td>
<td>4</td>
<td>`1.0f` (identity)</td>
<td>Row 2 column 2, scale Y
</td></tr>
<tr>
<td>`f32`</td>
<td>4</td>
<td>`0.0f` (identity)</td>
<td>Row 1 column 3, translation X
</td></tr>
<tr>
<td>`f32`</td>
<td>4</td>
<td>`0.0f` (identity)</td>
<td>Row 2 column 3, translation Y
</td></tr></tbody></table>
<p><br />
</p>
<h3><span class="mw-headline" id="Block_Description"><span class="mw-headline-number">1.2.4</span> Block Description</span></h3>
<p>These are the preamble for most shape forms like CEmbRect and CEmbCirc sections and effectively all objects which can be filled shapes with stitches. (Much credit to Josh Varga for figuring this data out).
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`section`</td>
<td>40</td>
<td></td>
<td><a href="#geometry">Block Geometry</a>, extents and affine transformation
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Is Open Path?
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>UseOutline
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Outline Stitch Type, 0 = Zigzag, 1 = run Stitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>outline_color_index
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Zigzag Width
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Zigzag Density
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Outline Run Pitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Run Stitch Run Times
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Triple Stitch Run Pitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Use OutLine Under Sewing.
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Use Sharp Corners
</td></tr>
<tr>
<td>`section`</td>
<td>?</td>
<td></td>
<td><a href="#motif">Motif</a>
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>EStitchOrVStitch?
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>EvStitchTallWidth
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>EvStitchHeight
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>EvStitchPointWidth
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>EVStitchRunTimes
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>EvStitchStrokeTimes
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>EvStitchArrange
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Use Fill?
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Fill Type
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Region Density
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Use Gradation
</td></tr>
<tr>
<td>`short_array`</td>
<td>2 × _N_</td>
<td></td>
<td>GradationValues
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>UseAdditionalColorInGradation
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Gradation Second Color
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>IsStitchDirectionVariable
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>StitchDirection
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>fill color, index of the fill color value.
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>BaseSewingStepPitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>BaseSewingStepFrequency
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>BaseSewingStitchType
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>FillHalfStitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>useFillAreaUnderSewing
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>FillAreaUnderSewingType, 0 = one direction, 1 = both directions.
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>RunningStitchPath, (comment "half-stitch?")
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`20`</td>
<td>ProgrammableFillPatternIndex (comment "20")
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ProgrammableFillWidth
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ProgrammableFillHeight
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ProgrammableFillRowOrColumn
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ProgrammableFillRowOffset
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ProgrammableFillColumnOffset
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ProgrammableFillDirection (comment: "WHERE IS PULL COMP")
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>UseBaseSewing     (comment: "Motif section")
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Pull Compensation
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`0`, false (default)</td>
<td>UseMotifPattern1
</td></tr>
<tr>
<td>`section`</td>
<td>?</td>
<td></td>
<td><a href="#motif">Motif</a>
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`0`, false (default)</td>
<td>UseMotifPattern2
</td></tr>
<tr>
<td>`section`</td>
<td>?</td>
<td></td>
<td><a href="#motif">Motif</a>
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>MotifRowOffset
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>MotifStitchDirection
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>MotifRunPitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>pipingStitchDirection
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>pipingStitchDensity
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>pipingStitchRunPitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>pipingStitchRunFrequency
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>CrossStitchSizeMeasure, 0 for size, 1 for ct, (comment: CrossStitch section)
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`25` (default)</td>
<td>CrossStitchSizeInMM
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`2` (default)</td>
<td>CrossStitchTimes
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`20` (default)</td>
<td>RadialDensity
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`20` (default)</td>
<td>RadialRunPitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>RadialCenterX (comment: 961)
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>RadialCenterY (comment: 847)
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`20` (default)</td>
<td>ConcentricCircleDensity
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`20` (default)</td>
<td>ConcentricCircleRunPitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ConcentricCircleCenterX (comment: 961)
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>ConcentricCircleCenterY (comment: 847)
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`20` (default)</td>
<td>SpiralDensity
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>`20` (default)</td>
<td>SpiralRunPitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>StipplingRunPitch
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>StipplingSpacing
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>OutlineEntryv1
</td></tr>
<tr>
<td>`float`</td>
<td>4</td>
<td></td>
<td>OutlineEntry
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>OutlineExitv1
</td></tr>
<tr>
<td>`float`</td>
<td>4</td>
<td></td>
<td>OutlineExit
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>RegionEntryv1
</td></tr>
<tr>
<td>`float`</td>
<td>4</td>
<td></td>
<td>RegionEntry
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>RegionExit
</td></tr>
<tr>
<td>`float`</td>
<td>4</td>
<td></td>
<td>RegionExitv1
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Motif"><span class="mw-headline-number">1.2.5</span> Motif</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Description
</th></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>Tile line count
</td></tr>
<tr>
<td>`section`</td>
<td>n tiles</td>
<td>Tile Lines
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Tile_line"><span class="mw-headline-number">1.2.6</span> Tile line</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Unknown
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Unknown
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Unknown
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Unknown
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td>_N_</td>
<td>Tile line point count
</td></tr>
<tr>
<td>`array`</td>
<td>2 × _N_</td>
<td></td>
<td>Point array
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Header"><span class="mw-headline-number">1.3</span> Header</span></h2>
<p>The first 12 bytes of the header section are common to all versions. PES versions 1 through 4 have a fixed predefined <a href="/en/Embroidery_format_PEC#PEC_thumbnail_image_subsection" title="Embroidery format PEC">PEC thread palette</a> of 64 threads. PES versions 5 and 6 replace this with configurable threads.
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0020"` | `"0025"` | `"0030"` | `"0040"` | `"0050"` |`"0055"` | `"0056"` |`"0060"`</td>
<td>Version 1, 2, 2.5, 3, 4, 5, 5.5, 5.6 or 6
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td></td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Version_1_header_section"><span class="mw-headline-number">1.3.1</span> Version 1 header section</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0001"`</td>
<td>Version 1
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td></td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1`</td>
<td>Hoop size where `0` is 100×100 mm², else 130×180 mm²
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1`</td>
<td>Use Existing Design Area
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td><a href="#PES-CSewSeg-sectionCSewSeg">segment block count</a> The number of objects. In version 1 this is the same as the number of CSewSeg blocks, as distinct from the number of segments within that block. In PE-Design objects are the things you can select.
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Version_2_header_section"><span class="mw-headline-number">1.3.2</span> Version 2 header section</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0020"`</td>
<td>Version 2
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr>
<tr>
<td><a href="#hoop-size-subsection">`hoop_size`</a></td>
<td>4</td>
<td>Hoop size
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>Hoop Rotation, 90° 1 = rotate.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>Unknown, design page background color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>Unknown, design page foreground color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, show grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, with axes?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, snap to grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, grid interval?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, P9 curves?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, optimize entry-exit points?
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Version_2.5_header_section"><span class="mw-headline-number">1.3.3</span> Version 2.5 header section</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0025"`</td>
<td>Version 2.5
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td></td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td><a href="#hoop-size-subsection">`hoop_size`</a></td>
<td>4</td>
<td></td>
<td>Hoop size
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Hoop Rotation, 90° 1 = rotate.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, design page background color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, design page foreground color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, show grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, with axes?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, snap to grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, grid interval?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, P9 curves?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, optimize entry-exit points?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>The number of Objects, this is the number of objects within the PES document and is not limited to the number of CSewSeg blocks. If there are two SewSeg objects and 2 Rectangle objects, this will be 4.
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Version_3_header_section"><span class="mw-headline-number">1.3.4</span> Version 3 header section</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0030"`</td>
<td>Version 3
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td></td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`char`</td>
<td>2</td>
<td>`02` | `10`</td>
<td>Subversion?
</td></tr>
<tr>
<td><a href="#hoop-size-subsection">`hoop_size`</a></td>
<td>4</td>
<td></td>
<td>Hoop size
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Hoop Rotation, 90° 1 = rotate.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, design page background color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, design page foreground color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, show grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, with axes?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, snap to grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, grid interval?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, P9 curves?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Unknown, optimize entry-exit points?
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Version_4_header_section"><span class="mw-headline-number">1.3.5</span> Version 4 header section</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0040"`</td>
<td>Version 4
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td></td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`char`</td>
<td>2</td>
<td>`02` | `10`</td>
<td>Subversion?
</td></tr>
<tr>
<td><a href="#Description_strings_subsection">`description_strings`</a></td>
<td></td>
<td></td>
<td>Description strings
</td></tr>
<tr>
<td>`u8`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td><a href="#hoop-size-subsection">`hoop_size`</a></td>
<td>4</td>
<td></td>
<td>Hoop size
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Hoop Rotation, 90° 1 = rotate.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`7` (typical)</td>
<td>Unknown, design page background color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`19` (typical)</td>
<td>Unknown, design page foreground color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` |&#160;?</td>
<td>Unknown, show grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Unknown, with axes?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` |&#160;?</td>
<td>Unknown, snap to grid?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`100` (typical)</td>
<td>Unknown, grid interval?
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>`1` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`u8`</td>
<td>7</td>
<td>`0` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Unknown
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Version_5_header_section"><span class="mw-headline-number">1.3.6</span> Version 5 header section</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0050"`</td>
<td>Version 5
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td></td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>"Hoop Size Indicator"
</td></tr>
<tr>
<td>`char`</td>
<td>2</td>
<td>`02` | `10`</td>
<td>Subversion?
</td></tr>
<tr>
<td><a href="#Description_strings_subsection">`description_strings`</a></td>
<td></td>
<td></td>
<td>Description strings
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>"Optimize Hoop Change"
</td></tr>
<tr>
<td><a href="#hoop-size-subsection">`hoop_size`</a></td>
<td>4</td>
<td></td>
<td>Hoop size
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Hoop Rotation, 90° 1 = rotate.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`7` (typical)</td>
<td>Design Page Background Color?
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`19` (typical)</td>
<td>Design Page Foreground Color
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` |&#160;?</td>
<td>"Show Grid"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>"With Axes"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` |&#160;?</td>
<td>"Snap To Grid"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`100` (typical)</td>
<td>"Grid Interval"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>"OptimizeEntryExitPoints"
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S0_ `0` (typical)</td>
<td>"fromImageStringLength"
</td></tr>
<tr>
<td>`char`</td>
<td>_S0_</td>
<td></td>
<td>Path string
</td></tr>
<tr>
<td><a href="#Affine_transform">`affine_transform`</a></td>
<td>24</td>
<td></td>
<td>Affine transform of image
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_S1_ `0` (typical)</td>
<td>Number of programmable fill patterns
</td></tr>
<tr>
<td><a href="#Programmable_fill_subsection">`fill patterns`</a></td>
<td>_S1_ *&#160;?</td>
<td>Programmable fill patterns
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_S2_ `0` (typical)</td>
<td>Number of programmable Motif
</td></tr>
<tr>
<td><a href="#motif">`motif`</a></td>
<td>_S2_ *&#160;?</td>
<td>Motif
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_S3_ `0` (typical)</td>
<td>Number of feather patterns
</td></tr>
<tr>
<td><a href="#Feather_Pattern_Subsection">`feather patterns`</a></td>
<td>_S3_ *&#160;?</td>
<td>Feather Patterns
</td></tr>
<tr>
<td><a href="#Color_list_subsection">`color_list`</a></td>
<td></td>
<td></td>
<td>Color list subsection
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>The number of Objects, this is the number of objects within the PES document and is not limited to the number of CSewSeg blocks. If there are two SewSeg objects and 2 Rectangle objects, this will be 4.
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Version_6_header_section"><span class="mw-headline-number">1.3.7</span> Version 6 header section</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"#PES"`</td>
<td>PES Identification
</td></tr>
<tr>
<td>`char`</td>
<td>4</td>
<td>`"0060"`</td>
<td>Version 6
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td></td>
<td>Absolute <a href="#PEC_section">PEC section</a> byte offset
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Hoop Size Indicator
</td></tr>
<tr>
<td>`char`</td>
<td>2</td>
<td>`02` | `10`</td>
<td>Subversion?
</td></tr>
<tr>
<td><a href="#Description_strings_subsection">`description_strings`</a></td>
<td></td>
<td></td>
<td>Description strings
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>Optimize Hoop Change
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>Design Page Is Custom
</td></tr>
<tr>
<td><a href="#hoop-size-subsection">`hoop_size`</a></td>
<td>4</td>
<td></td>
<td>Hoop size
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Hoop Rotation, 90° 1 = rotate.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`200` (typical)</td>
<td>DesignWidth
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`200` (typical)</td>
<td>DesignHeight
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`100` (typical)</td>
<td>DesignPageWidth
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`100` (typical)</td>
<td>DesignPageHeight
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`100` (typical)</td>
<td>Undisplayed Unknown Design Property, must fall within same range as designPageWidth and Height. Makes no difference other than validation check.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`7` (typical)</td>
<td>"Design Page Background Color"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`19` (typical)</td>
<td>"Design Page Foreground Color"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` |&#160;?</td>
<td>"Show Grid"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>"With Axes"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>"Snap To Grid"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`100` |&#160;?</td>
<td>"Grid Interval"
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1`</td>
<td>Unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>"OptimizeEntryExitPoints"
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S0_ `0` (typical)</td>
<td>"fromImageStringLength"
</td></tr>
<tr>
<td>`char`</td>
<td>_S0_</td>
<td></td>
<td>Path string
</td></tr>
<tr>
<td><a href="#Affine_transform">`affine_transform`</a></td>
<td>24</td>
<td></td>
<td>Affine transform of image
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_S1_ `0` (typical)</td>
<td>Number of programmable fill patterns
</td></tr>
<tr>
<td><a href="#Programmable_fill_subsection">`fill patterns`</a></td>
<td>_S1_ *&#160;?</td>
<td>Programmable fill patterns
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_S2_ `0` (typical)</td>
<td>Number of programmable Motif
</td></tr>
<tr>
<td><a href="#motif">`motif`</a></td>
<td>_S2_ *&#160;?</td>
<td>Motif
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_S3_ `0` (typical)</td>
<td>Number of feather patterns
</td></tr>
<tr>
<td><a href="#Feather_Pattern_Subsection">`feather patterns`</a></td>
<td>_S3_ *&#160;?</td>
<td>Feather Patterns
</td></tr>
<tr>
<td><a href="#Color_list_subsection">`color_list`</a></td>
<td></td>
<td></td>
<td>Color list subsection
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>The number of Objects, this is the number of objects within the PES document and is not limited to the number of CSewSeg blocks. If there are two SewSeg objects and 2 Rectangle objects, this will be 4.
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Programmable_fill_subsection"><span class="mw-headline-number">1.3.8</span> Programmable fill subsection</span></h3>
<h3><span class="mw-headline" id="Motif_subsection"><span class="mw-headline-number">1.3.9</span> Motif subsection</span></h3>
<h3><span class="mw-headline" id="Feather_Pattern_Subsection"><span class="mw-headline-number">1.3.10</span> Feather Pattern Subsection</span></h3>
<h3><span class="mw-headline" id="Hoop_size_subsection"><span class="mw-headline-number">1.3.11</span> Hoop size subsection</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Hoop width [mm]
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Hoop height [mm]
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Description_strings_subsection"><span class="mw-headline-number">1.3.12</span> Description strings subsection</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S1_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S1_</td>
<td></td>
<td>Design string
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S2_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S2_</td>
<td></td>
<td>Category string
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S3_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S3_</td>
<td></td>
<td>Author string
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S4_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S4_</td>
<td></td>
<td>Keywords string
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S5_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S5_</td>
<td></td>
<td>Comments string
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Color_list_subsection"><span class="mw-headline-number">1.3.13</span> Color list subsection</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Number of following color subsections
</td></tr>
<tr>
<td><a href="#Color_subsection">`color`</a></td>
<td></td>
<td></td>
<td>Color subsections
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Color_subsection"><span class="mw-headline-number">1.3.14</span> Color subsection</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S1_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S1_</td>
<td>`"575"` | etc.</td>
<td>Color code, numeric 0-6 digit number.
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>`0 ` – `255`</td>
<td>Red component of RGB color model
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>`0 ` – `255`</td>
<td>Green component of RGB color model
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>`0 ` – `255`</td>
<td>Blue component of RGB color model
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>`0` (typical)</td>
<td>Unknown (likely padding, writes color as 32 bit rather than 24 bit)
</td></tr>
<tr>
<td>`u32`</td>
<td>4</td>
<td>`0x1` | `0x2` | `0xA` | `0xB`</td>
<td>Color Type. 0 is custom list color. 1 is list color (Eg. 1615  MA Polyneon). 2 is an applique, description is either 100, 101, 102 (APPLIQUE MATERIAL, APPLIQUE POSITION, APPLIQUE respectively). A is custom color, not from a list eg (Red, Wilcom). B is Version 4 special list brother specific color.
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S2_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S2_</td>
<td>`"Orange"` | etc.</td>
<td>Description.
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S3_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S3_</td>
<td>`"RA Polyester"` | etc.</td>
<td>Brand
</td></tr>
<tr>
<td>`u8`</td>
<td>1</td>
<td>_S4_</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>_S4_</td>
<td>`"Stock"` | etc.</td>
<td>Color chart name (Usually _S4_ is 0, and this is absent)
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CEmbOne"><span class="mw-headline-number">1.4</span> CEmbOne</span></h2>
<p>The CEmbOne section is always 73 bytes in size. The data within the object is identical to the data for the appended headers of addition <a href="#PES-CSewSeg-section">CSewSeg</a> objects. The data here is the header information for the first (and often only) group within that section.
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`7`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>7</td>
<td>`"CEmbOne"`</td>
<td>CEmbOne identification
</td></tr>
<tr>
<td>`section`</td>
<td>64</td>
<td></td>
<td><a href="#CEmbOne_Header">CSewSeg Header</a>
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CSewSeg"><span class="mw-headline-number">1.5</span> CSewSeg</span></h2>
<p>The first <a href="#CSewSeg_segment_block">CSewSeg segment block</a>'s header is the data of the <a href="#CEmbOne">CEmbOne</a> block. If the <a href="#PES_header">PES header</a> declares the number of <a href="#CSewSeg_segment_block">csewseg segment blocks</a> to be 1, then this block contains only the <a href="#CSewSeg_segment_block">CSewSeg segment block</a>. If zero then this block would have been omitted. But, if greater than one, then additional <a href="#CEmbOne_Header">headers</a> and <a href="#CSewSeg_segment_block">CSewSeg segment block</a> are appended within this block.
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`7`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>7</td>
<td>`"CSewSeg"`</td>
<td>CSewSeg identification
</td></tr>
<tr>
<td><a href="#CSewSeg_segment_block">CSewSeg segment block</a></td>
<td></td>
<td></td>
<td>CSewSeg segment block
</td></tr>
<tr>
<td><a href="#CEmbOne_Header">headers</a></td>
<td></td>
<td></td>
<td>CSewSeg header (optional)
</td></tr>
<tr>
<td><a href="#CSewSeg_segment_block">`segment block`</a></td>
<td></td>
<td></td>
<td>CSewSeg segment block (optional)
</td></tr>
<tr>
<td>...</td>
<td></td>
<td></td>
<td>Additional header / segment-block sequences (optional)
</td></tr></tbody></table>
<h3><span class="mw-headline" id="CSewSeg_segment_block"><span class="mw-headline-number">1.5.1</span> CSewSeg segment block</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td><a href="#CSewSeg_stitch_list_subsection">`csewseg_stitch_list`</a></td>
<td></td>
<td></td>
<td>CSewSeg stitch list subsection
</td></tr>
<tr>
<td><a href="#CSewSeg_color_list_subsection">`csewseg_color_list`</a></td>
<td></td>
<td></td>
<td>CSewSeg color list subsection
</td></tr></tbody></table>
<h4><span class="mw-headline" id="CSewSeg_stitch_list_subsection"><span class="mw-headline-number">1.5.1.1</span> CSewSeg stitch list subsection</span></h4>
<p>The CSewSeg stitch list subsection is divided into stitch blocks. The last block does not end with the continuation code `0x8003` and so is 2 bytes shorter than the others. Some files seem to limit the number of stitches to a maximum of 1000 per block, is this required?
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` |&#160;?</td>
<td>Stitch type where `0` means a normal stitch and `1` means a jump stitch
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Thread index for block + 1
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_N_</td>
<td>Number of following coordinates
</td></tr>
<tr>
<td><a href="#CSewSeg_coordinate_subsection">`csewseg_coordinates`</a></td>
<td>4 × _N_</td>
<td></td>
<td>CSewSeg coordinate subsection
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>?</td>
<td>Continuation code where `0x8003` means list continues with another following block, with the last block not having this field at all
</td></tr></tbody></table>
<h4><span class="mw-headline" id="CSewSeg_coordinate_subsection"><span class="mw-headline-number">1.5.1.2</span> CSewSeg coordinate subsection</span></h4>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Stitch x coordinate
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td>Stitch y coordinate
</td></tr></tbody></table>
<h4><span class="mw-headline" id="CSewSeg_color_list_subsection"><span class="mw-headline-number">1.5.1.3</span> CSewSeg color list subsection</span></h4>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>_N_</td>
<td>Number of following colors
</td></tr>
<tr>
<td><a href="#CSewSeg_color_subsection">`csewseg_color`</a></td>
<td>4 × _N_</td>
<td></td>
<td>CSewSeg color subsection
</td></tr></tbody></table>
<h4><span class="mw-headline" id="CSewSeg_color_subsection"><span class="mw-headline-number">1.5.1.4</span> CSewSeg color subsection</span></h4>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Block index where change of thread takes effect, starting from zero
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>In PES versions 1 through 4 this is a <a href="/en/Embroidery_format_PEC#PEC_colors" title="Embroidery format PEC">PEC thread palette</a> index and in versions 5 and 6 this is a <a href="#color-list-subsection">thread index</a> defined in the <a href="#Header">PES header section</a>
</td></tr></tbody></table>
<h3><span class="mw-headline" id="CEmbOne_Header"><span class="mw-headline-number">1.5.2</span> CEmbOne Header</span></h3>
<p>The header for the first block is contained within the <a href="#CEmbOne">CEmbOne</a> section. However, if the <a href="#Header">PES Header</a> specified that there would be more than one CSewSeg object these headers will be appended along with additional stitchgroups.
</p>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`7`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>7</td>
<td>`"CEmbOne"`</td>
<td>CEmbOne identification
</td></tr>
<tr>
<td>`section`</td>
<td>40</td>
<td></td>
<td><a href="#geometry">Block Geometry</a>, Extents and Affine Transformation
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`1` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td><a href="#CSewSeg">CSewSeg</a> x coordinate translation?
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td><a href="#CSewSeg">CSewSeg</a> y coordinate translation?
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td><a href="#CSewSeg">CSewSeg</a> width
</td></tr>
<tr>
<td>`s16`</td>
<td>2</td>
<td></td>
<td><a href="#CSewSeg">CSewSeg</a> height
</td></tr>
<tr>
<td>`u8`</td>
<td>8</td>
<td>`0` (typical)</td>
<td>8 bytes of unknown, zero.
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td><a href="#CSewSeg">CSewSeg</a> block count
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CEmbCirc"><span class="mw-headline-number">1.6</span> CEmbCirc</span></h2>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`8`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>8</td>
<td>`"CEmbCirc"`</td>
<td>CEmbCirc identification
</td></tr>
<tr>
<td>`section`</td>
<td>?</td>
<td><a href="#Block_Description">`block_description`</a></td>
<td>Block Description
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>Type
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>start angle
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>end angle
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>left
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>top
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>right
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>bottom
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CEmbRect"><span class="mw-headline-number">1.7</span> CEmbRect</span></h2>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`8`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>8</td>
<td>`"CEmbRect"`</td>
<td>CEmbRect identification
</td></tr>
<tr>
<td>`section`</td>
<td>240 + motifs</td>
<td><a href="#Block_Description">`block_description`</a></td>
<td>Block Description
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>corner_radius
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>left
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>top
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>right
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>bottom
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CEmbLine"><span class="mw-headline-number">1.8</span> CEmbLine</span></h2>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`8`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>8</td>
<td>`"CEmbLine"`</td>
<td>CEmbLine identification
</td></tr>
<tr>
<td>`section`</td>
<td>?</td>
<td><a href="#Block_Description">`block_description`</a></td>
<td>Block Description
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>vertex count, number of vertexes to expect.
</td></tr>
<tr>
<td>`section`</td>
<td>count * 8</td>
<td></td>
<td>series of vertexes.
</td></tr></tbody></table>
<h3><span class="mw-headline" id="Point_List"><span class="mw-headline-number">1.8.1</span> Point List</span></h3>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>p1
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>p2
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>p3
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td></td>
<td>type
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CEmbPunch"><span class="mw-headline-number">1.9</span> CEmbPunch</span></h2>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`9`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>9</td>
<td>`"CEmbPunch"`</td>
<td>CEmbPunch identification
</td></tr>
<tr>
<td>?</td>
<td>?</td>
<td></td>
<td>Unknown
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CSewFigSeg"><span class="mw-headline-number">1.10</span> CSewFigSeg</span></h2>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`10`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>10</td>
<td>`"CSewFigSeg"`</td>
<td>CSewFigSeg identification
</td></tr>
<tr>
<td>?</td>
<td>?</td>
<td></td>
<td>Unknown
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CLetter"><span class="mw-headline-number">1.11</span> CLetter</span></h2>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`7`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>7</td>
<td>`"CLetter"`</td>
<td>CLetter identification
</td></tr>
<tr>
<td>?</td>
<td>?</td>
<td></td>
<td>Unknown
</td></tr></tbody></table>
<h2><span class="mw-headline" id="CEmbNText"><span class="mw-headline-number">1.12</span> CEmbNText</span></h2>
<table class="wikitable">

<tbody><tr>
<th>Type</th>
<th>Bytes</th>
<th>Value</th>
<th>Description
</th></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`9`</td>
<td>Length of following string
</td></tr>
<tr>
<td>`char`</td>
<td>9</td>
<td>`"CEmbNText"`</td>
<td>CEmbNText identification
</td></tr>
<tr>
<td>?</td>
<td>?</td>
<td></td>
<td>Unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0xFFFF` (typical)</td>
<td>Unknown
</td></tr>
<tr>
<td>`u16`</td>
<td>2</td>
<td>`0` (typical)</td>
<td>Unknown
</td></tr></tbody></table>
<h2><span class="mw-headline" id="PEC_Addendum"><span class="mw-headline-number">1.13</span> PEC Addendum</span></h2>
<p>There is a block in that exists in V4 to V6 and likely beyond of PES, which includes what appears to be addendum PEC information and occurs after the traditional PEC graphics block ends.
</p><p>Without this block version 6 of the files cannot be detected on the various embroidery machines. For a successful write of V6 it must be included.
</p>
<h3><span class="mw-headline" id="PEC_Addendum_header"><span class="mw-headline-number">1.13.1</span> PEC Addendum header</span></h3>
<p>The block starts with the count index, where 0 is FF and 1 is 00. In the same N-1 format of the PEC colors. This is followed by the PEC colors. Though in Brother's own rendering of these files using 0 is fine for the colors as they also use in the PEC blocks. One assumes since they included the data in the PES header it will know what the colors actually are.
</p><p>This is then padded out by 0x20 just as the PEC header is, to 128 bytes.
</p><p>A blank version of this will be 0xFF followed by 127 bytes of 0x20.
</p>
<h3><span class="mw-headline" id="PEC_Addendum_color_info"><span class="mw-headline-number">1.13.2</span> PEC Addendum color info</span></h3>
<p>For each color in the Addendum header, we have 0x90 bytes (144 bytes) of information.
The only thing that seems to dictate the data that is used here is the color used. Each color seems to result in a different set of data. However, brother has some colors produce an entirely 0 amount of data. The only thing that matters for this data is what color was used.
</p>
<h3><span class="mw-headline" id="PEC_Addendum_RGB_List"><span class="mw-headline-number">1.13.3</span> PEC Addendum RGB List</span></h3>
<p>After the blocks of 144 bytes for each color, we produce a simple list of the RGB colors of these threads. So if we had 5 colors we produce 15 bytes of RGBRGBRGBRGBRGB dumped after the last color info block.
</p><p>In Version 6, we add two bytes of 0. 00 00 after the RGB list. This isn't included in V5 or V4. It is unknown if it's part of the block or something related to this being the end of file or something.
</p>
<h2><span class="mw-headline" id="Write_PES_V.1"><span class="mw-headline-number">1.14</span> Write PES V.1</span></h2>
<p>We can read PES and PEC for all versions by reading the color data and stitch data from the PEC block. But, the typical use case is going to be writing a successful PES file.
[all writes should be done Little Endian].
</p><p>We must write the following things to disk.
</p>
<ul><li>8 bytes: "#PES0001"</li>
<li>4 bytes: Location of PEC block.</li>
<li>2 bytes: 1 (scale to fit)</li>
<li>2 bytes: 1 (hoop size, 130mm 180mm)</li>
<li>2 bytes: 1 (we are going to write only one stitchblock object).</li>
<li>4 bytes: FF FF 00 00, end the header.</li></ul>
<h3><span class="mw-headline" id="Write_CEmbOne"><span class="mw-headline-number">1.14.1</span> Write CEmbOne</span></h3>
<ul><li>2 bytes: 7 (length of text "EmbOne")</li>
<li>7 bytes: "EmbOne"</li>
<li>2 bytes: 0, minX (we're passing on this)</li>
<li>2 bytes: 0, minY (we're passing on this)</li>
<li>2 bytes: 0, maxX (we're passing on this)</li>
<li>2 bytes: 0, maxY (we're passing on this).</li>
<li>2 bytes: 0, minX (we're passing on this)</li>
<li>2 bytes: 0, minY (we're passing on this)</li>
<li>2 bytes: 0, maxX (we're passing on this)</li>
<li>2 bytes: 0, maxY (we're passing on this).</li>
<li>4 bytes: float 1, 00 00 80 3F (Scale X)</li>
<li>4 bytes: float 0, 00 00 00 00 (Skew_X)</li>
<li>4 bytes: float 0, 00 00 00 00 (Skew_Y)</li>
<li>4 bytes: float 1, 00 00 80 3F (Scale_Y)</li>
<li>4 bytes: float (350 + HoopWidth/2 - WidthOfDesign/2), 350 is the distance from 0,0 that the 130mm x 180mm hoop is stored, if we add half the HoopWidth (1300 / 2) and subtract half our design's width. The embroidery will be centered in the hoop.</li>
<li>4 bytes float (100 + HoopHeight/2 - HeightOfDesign/2), 100 is the distance from 0,0 that our 130mm x 180mm hoop is stored, if we add half the HoopHeight (1800 / 2) and subtract half our design's height. The embroidery will be centered in the hoop.</li>
<li>2 bytes: 1, unknown.</li>
<li>2 bytes: 0, X-location (we're passing on this).</li>
<li>2 bytes 0, Y-location (we're passing on this).</li>
<li>2 bytes width, WidthOfDesign</li>
<li>2 bytes height, WidthOfDesign.</li>
<li>4 bytes, 0, unknown.</li>
<li>4 bytes, 0 unknown.</li>
<li>2 bytes, number of segments + (2 * colorChanges), this is going to be the number of segments we will need to use.</li></ul>
<ul><li>4 bytes FF FF 00 00, end block.</li></ul>
<h3><span class="mw-headline" id="Write_CSewSeg"><span class="mw-headline-number">1.14.2</span> Write CSewSeg</span></h3>
<ul><li>2 bytes: 7, length of "CSewSeg"</li>
<li>7 bytes: "CSewSeg"</li></ul>
<h3><span class="mw-headline" id="Writing_Segment_Information"><span class="mw-headline-number">1.14.3</span> Writing Segment Information</span></h3>
<p>For these, we must ensure our segments are flagged 0,1,0,1,0,1,0. That our jumps are 0, that our stitches are 1, that our color changes are 0, we pad with jumps and stitches to nowhere to maintain this. We assume that we jump to the location, then color change, then stitch as relevant.
</p>
<h4><span id="Color_Change,_Initialize"></span><span class="mw-headline" id="Color_Change.2C_Initialize"><span class="mw-headline-number">1.14.3.1</span> Color Change, Initialize</span></h4>
<ul><li>2 bytes: 1 this is a stitch.</li>
<li>2 bytes color, color index.</li>
<li>2 bytes 2, needs a length of at least two to not be a color change.</li>
<li>2 byes: X, current position X.</li>
<li>2 bytes: Y, current position Y.</li>
<li>2 byes: X, current position X.</li>
<li>2 bytes: Y, current position Y.</li>
<li>2 bytes 0x8001, 01 80. End Segment</li>
<li>2 bytes: 0, non-stitching.</li>
<li>2 bytes, color, color index.</li>
<li>2 bytes, 2, needs a length of at least two to not be a color change.</li>
<li>2 byes: X, current position X.</li>
<li>2 bytes: Y, current position Y.</li>
<li>2 byes: X, current position X.</li>
<li>2 bytes: Y, current position Y.</li>
<li>2 bytes 0x8001, 01 80. End Segment</li></ul>
<p>(We didn't call a color change event, but we ensured that the initial color is established)
</p>
<h4><span id="Color_Change,_Middle"></span><span class="mw-headline" id="Color_Change.2C_Middle"><span class="mw-headline-number">1.14.3.2</span> Color Change, Middle</span></h4>
<ul><li>2 bytes: 0, we are not sewing this</li>
<li>2 bytes: Color, color index. Index of old color.</li>
<li>2 byte: 1, length of stitches.</li>
<li>2 byes: X, current position X.</li>
<li>2 bytes: Y, current position Y.</li>
<li>2 bytes 0x8001, 01 80. End Segment</li>
<li>2 bytes: 1, we are sewing this.</li>
<li>2 bytes: Color, color index. Index of new color.</li>
<li>2 bytes: 2, length two.</li>
<li>2 byes: X, current position X.</li>
<li>2 bytes: Y, current position Y.</li>
<li>2 byes: X, current position X.</li>
<li>2 bytes: Y, current position Y.</li>
<li>2 bytes 0x8001, 01 80. End Segment</li></ul>
<p>(We invoked a color change, and then a sewable event that went nowhere, to make sure the color is established.)
</p>
<h4><span class="mw-headline" id="Jump"><span class="mw-headline-number">1.14.3.3</span> Jump</span></h4>
<ul><li>2 bytes, 0, we are not stitching.</li>
<li>2 bytes, Color, whatever color we're on.</li>
<li>2 bytes, length, the number of stitches in this jump, including start and end (minimum 2).</li>
<li>NN bytes, X position, Y position (relative to the position given to the StitchGroup description).</li>
<li>2 bytes 0x8001, 01 80. End Segment</li></ul>
<h4><span class="mw-headline" id="Stitch"><span class="mw-headline-number">1.14.3.4</span> Stitch</span></h4>
<ul><li>2 bytes, 1, we are stitching.</li>
<li>2 bytes, Color, whatever color we're on.</li>
<li>2 bytes, length, the number of stitches in this block, including start and end (minimum 2).</li>
<li>NN bytes, X position, Y position (relative to the position given to the StitchGroup description).</li>
<li>2 bytes 0x8001, 01 80. End Segment</li></ul>
<h4><span class="mw-headline" id="Color_change"><span class="mw-headline-number">1.14.3.5</span> Color change</span></h4>
<p>We now write the color change log. 
</p>
<ul><li>2 bytes: Number of color changes</li></ul>
<p>For each color change:
</p>
<ul><li>2 bytes: Section at which this change occurred. (Note this must account for the initialization and the padding sections we added.</li>
<li>2 bytes: Color Change, old index value.</li></ul>
<p>Continue to <a href="/en/Embroidery_format_PEC#Writing_PEC" title="Embroidery format PEC">Write PEC</a>
</p>
<h2><span class="mw-headline" id="Write_PES_v.6"><span class="mw-headline-number">1.15</span> Write PES v.6</span></h2>
<p>When writing PES v.6 we must note that the PES colors are not the index colors from the PEC-Threads but rather the colors we defined in the header.
</p>
<ul><li>Write, 8 bytes, "#PES0060"</li>
<li>Write, 2 bytes, 1, // 0 = 100x100 else 130x180 or above</li>
<li>Write, 1 byte, 0x30, dunno</li>
<li>Write, 1 byte, 0x32, dunno.</li>
<li>Write, 1 byte, name length (if this is 0, name is omitted)</li>
<li>Write, name length bytes, name.</li>
<li>Write, 1 byte, category length (if this is 0, category is omitted)</li>
<li>Write, category length bytes, category.</li>
<li>Write, 1 byte, author length (if this is 0, author is omitted)</li>
<li>Write, author length bytes, author.</li>
<li>Write, 1 byte, keywords length (if this is 0, keywords is omitted)</li>
<li>Write, keywords length bytes, keywords.</li>
<li>Write, 1 byte, comments length (if this is 0, comment is omitted)</li>
<li>Write, comment length bytes, comment.</li>
<li>Write, 2 bytes, 0, optimizeHoopChange false</li>
<li>Write, 2 bytes, 0, DesignPageIsCustom false.</li>
<li>Write, 2 bytes, 0x64, HoopWidth</li>
<li>Write, 2 bytes, 0x64, HoopHeight</li>
<li>Write, 2 bytes, 0, Design Page Area</li>
<li>Write, 2 bytes, 0xC8, designWidth</li>
<li>Write, 2 bytes, 0xC8, designHeight</li>
<li>Write, 2 bytes, 0x64, designPageSectionWidth</li>
<li>Write, 2 bytes, 0x64, designPageSectionHeight</li>
<li>Write, 2 bytes, 0x64, p6, unknown but 100.</li>
<li>Write, 2 bytes, 0x07, designPageBackgroundColor</li>
<li>Write, 2 bytes, 0x13, designPageForegroundColor</li>
<li>Write, 2 bytes, 0x01, ShowGrid true.</li>
<li>Write, 2 bytes, 0x01, WithAxes true</li>
<li>Write, 2 bytes, 0x00, SnapToGrid false</li>
<li>Write, 2 bytes 100, GridInterval 100</li>
<li>Write, 2 bytes, 0x01, p9, unknown</li>
<li>Write, 2 bytes, 0, OptimizeEntryExitPoints false</li>
<li>Write, 1 byte, 0, fromImageStringLength, if non-zero file name must follow.</li>
<li>Write, 4 bytes, float(1f), image scaleX</li>
<li>Write, 4 bytes, float(0f), image</li>
<li>Write, 4 bytes, float(0f), image</li>
<li>Write, 4 bytes, float(1f), image scaleY</li>
<li>Write, 4 bytes, float(0f), image</li>
<li>Write, 4 bytes, float(0f), image</li>
<li>Write, 2 bytes, 0, numberOfProgrammableFillPatterns</li>
<li>Write, 2 bytes, 0, NumberOfMotifPatterns</li>
<li>Write, 2 bytes, 0, NumberOfFeatherPatterns</li>
<li>Write, 2 bytes, #colors, numberOfThreads.</li></ul>
<p>For each thread:
</p>
<ul><li>Write, 1 byte, catalogNumber string length</li>
<li>Write, 0-6 byte, catalogNumber should be 0-6 digits long numeric.</li>
<li>Write, 1 byte, red</li>
<li>Write, 1 byte, green</li>
<li>Write, 1 byte, blue</li>
<li>Write, 1 bytes, 0, unknown.</li>
<li>Write, 4 bytes, 0xA, thread type.</li>
<li>Write, 1 byte, Description length</li>
<li>Write, n bytes, Description</li>
<li>Write, 1 byte, Brand length</li>
<li>Write, n bytes, Brand</li>
<li>Write, 1 byte, Chart length</li>
<li>Write, n bytes, Chart</li></ul>
<p>After threads, back to header.
</p>
<ul><li>Write, 2 bytes, 1, Objects In Pes.</li></ul>
<p>Write block data in the same way as V.1, except using predefined colors rather than PEC Thread.
</p>
<ul><li>Write CEmbOne block</li>
<li>Write CSewSeg block</li></ul>
<p>We should end after the color log of the CSewSeg block. With the four byte, 0x0000 0x0000 terminator.
</p>
<h3><span class="mw-headline" id="Write_Order_Data"><span class="mw-headline-number">1.15.1</span> Write Order Data</span></h3>
<ul><li>Write, 8 bytes, 0 0 0 0 0 0 0 0, (this makes 12 zeros in a row with the terminator).</li>
<li>Write, n order data chunks. Where n is the same as the number of color changes we wrote in the colors section.</li></ul>
<p>Each Order Chunk.
</p>
<ul><li>Write, 4 bytes, i</li>
<li>Write, 4 bytes, 0</li></ul>
<p>So for 3 elements we would write (not including the 00 00 00 00 terminator this comes right after):
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00
</p><p><br />
Continue to <a href="/en/Embroidery_format_PEC#Writing_PEC" title="Embroidery format PEC">Write PEC</a>
</p>
<h3><span class="mw-headline" id="Write_Addendum_block"><span class="mw-headline-number">1.15.2</span> Write Addendum block</span></h3>
<p>Write the PEC color count in N-1 with 0 becoming FF.
Write the PEC colors after that.
Pad the block at 128 bytes of 0x20 (ASCII-32, space)
For each PEC color write: 0x90 elements (144) copies of 0. 
Write each RGB color, in 3 byte increments blocks.
</p><p>Write 2 bytes of 0. 0x00 0x00 (this only appears at V6).
</p>
<h2><span class="mw-headline" id="Write_Truncated_v.6"><span class="mw-headline-number">1.16</span> Write Truncated v.6</span></h2>
<p>The valid header for a blank v.6 PES file is:
23 50 45 53 30 30 36 30 64 00 00 00 01 00 30 31 00 00 00 00 00 01 00 00 00 64 00 64 00 00 00 C8 00 C8 00 64 00 64 00 64 00 0C 00 13 00 01 00 00 00 00 00 19 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 00 00 00 00 80 3F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
</p><p>This works but suffers from some rather notable oddities since the colors are absent and expected. PE-Design loads blank as there's no data for it. Wilcom loads with random colors, despite there still being valid PEC colors in the PEC block. However, we could rectify that if we realize that the reason for omitting the harder to write segment blocks is that the segment value is zero. We could simply write in some threads *and* then say there's no segments. In theory most readers will iterate through and find the threads, and load those, then seek to the PEC block. That makes it pretty easy to feed it correct data such a reader would be looking for.
</p>
<h2><span class="mw-headline" id="Write_PEC_v.1"><span class="mw-headline-number">1.17</span> Write PEC v.1</span></h2>
<p>File should end with .pec
Write "#PEC0001"
Continue to <a href="/en/Embroidery_format_PEC#Writing_PEC" title="Embroidery format PEC">Write PEC</a>
</p><p><br />
</p>
<h2><span class="mw-headline" id="Write_Truncated_PES_v.1"><span class="mw-headline-number">1.18</span> Write Truncated PES v.1</span></h2>
<ul><li>Write #PES0001</li>
<li>Write 1 byte 0x16</li>
<li>Write 13 bytes 0x00</li></ul>
<p>Continue to <a href="/en/Embroidery_format_PEC#Writing_PEC" title="Embroidery format PEC">Write PEC</a>
</p>
<h3><span class="mw-headline" id="Notes"><span class="mw-headline-number">1.18.1</span> Notes</span></h3>
<p>The PES block, in total, is:
</p>
<ul><li>23 50 45 53 30 30 30 31 16 00 00 00 00 00 00 00 00 00 00 00 00 00</li></ul>
<p>No software other than PE-Design will notice, and PE-Design will load normally and display a blank document.
</p>
<h2><span class="mw-headline" id="Writing_Ultra-Trucated_PES_v.1"><span class="mw-headline-number">1.19</span> Writing Ultra-Trucated PES v.1</span></h2>
<ul><li>Write #PES0001</li>
<li>Write 0x0c 0x00 0x00 0x00</li></ul>
<p>Continue to <a href="/en/Embroidery_format_PEC#Writing_PEC" title="Embroidery format PEC">Write PEC</a>
</p>
<h3><span class="mw-headline" id="Notes_2"><span class="mw-headline-number">1.19.1</span> Notes</span></h3>
<p>This PES block is in total: "#PES0001" 'u32' 12 (0C 00 00 00), the truncated header is 12 bytes in total. The magic number tag and the 4 bytes that says the PEC file starts at the 12th (0x0C) byte.
</p><p>PE-Design will crash, but no other software will notice that there's no PES or header.
</p><p>As a practical concern, most embroidery in .pes format does not actually contain any of that design information data, it only contains the line segment data, which is very difficult to edit, resize (significantly), etc.
</p>
<h2><span class="mw-headline" id="PES_Block_Removing"><span class="mw-headline-number">1.20</span> PES Block Removing</span></h2>
<p>The only thing that reads the PES block is PE-DESIGN which is proprietary, Windows only, and expensive (like nearly all embroidery software). So if the desire is to use Brother embroidery machines rather than Brother embroidery software it would be sufficient to write a minimal PES block a version 1 header and declare the start of the PEC block just after the header and no segment-block elements:
</p><p>`23 50 45 53 30 30 30 31 16 00 00 00 00 00 00 00 00 00 00 00 00 00`
</p><p>`#  P  E  S  0  0  0  1  .  .  .  .  .  .  .  .  .  .  .  .  .  . `
</p><p>This is, #PES0001 followed by a single byte 0x16 and then 13 zeros. This is immediately followed by the PEC block. All software will read this as correct. This is a valid PES block for a Version 1 blank document. Only PE-DESIGN reads the PES block all other software will read the PEC block only, to PE-DESIGN this is a valid blank document.
</p><p>It is also possible truncate the header, and nearly no software will realize there is an invalid header because most all software doesn't read the PES header or anything about the PES part of the file:
</p><p>`23 50 45 53 30 30 30 31 0C 00 00 00 `
</p><p>`#  P  E  S  0  0  0  1  .  .  .  .  `
</p><p>This is an invalid header, but no software other than PE-DESIGN will realize it, because nearly all software only reads the file version preamble, e.g. #PES0001, then the 4 bytes for where it needs to seek within the file to find the PEC block, and then the PEC block. Here we simply declare it starts at the 12th byte, and omit the 10 zeros additionals zeros which would make the header valid. Other software won't notice, and PE-DESIGN will throw an error, rather than load a blank document without objection.
</p>
<h2><span class="mw-headline" id="PEC_Block_Removal"><span class="mw-headline-number">1.21</span> PEC Block Removal</span></h2>
<p>Likewise PE-DESIGN does not read any of the PEC block data, with the exception of a preview window in the open file dialog. You can set the declared PEC location to garbage and remove all the PEC data from the file and PE-DESIGN will not care.
</p><p>Between the PES blocks between which there are two control codes 00 00 00 00 and FF FF 00 00 which mean END-OF-FILE and CONTINUE. It is the case that after the 00 00 00 00 code, PE-DESIGN stops reading. It will throw no error for any data beyond that section. And stops reading. Between the 00 00 00 00 stop and the PEC block, you could put any data. So long as the PES block is valid, and the PEC seek value is accurate, you could have a valid .pec file with both a complete PEC block and a complete PES block and a bunch of any data between them.
</p><p>In special cases, where the design goes outside the the allowed hoop within PE-Design the program itself will save the data without saving the card data which leads to a blank PEC section. While it exists it contains a name 0 colors (0xFF) a blank image, and some trailing zeros.
</p>

<p>
<Strong>Credits</strong><BR>
PES File information in this section.
https://edutechwiki.unige.ch/en/Embroidery_format_PES<BR>
<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="CreativeCommons"><img src="https://edutechwiki.unige.ch/mediawiki/tecfa/somerights.png"></a> 

</p>

      </div>
      <!-- /.container-fluid -->

      <!-- Sticky Footer -->
      <footer class="sticky-footer">
        <div class="container my-auto">
          <div class="copyright text-center my-auto">
            <span>Copyright Â© OneOfTheInfiniteMonkeys 2020</span>
          </div>
        </div>
      </footer>

    </div>
    <!-- /.content-wrapper -->

  </div>
  <!-- /#wrapper -->

  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>

  <!-- Logout Modal-->
  <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">Ã—</span>
          </button>
        </div>
        <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
          <a class="btn btn-primary" href="login.html">Logout</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap core JavaScript-->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Core plugin JavaScript-->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Custom scripts for all pages-->
  <script src="js/sb-admin.min.js"></script>

</body>

</html>
